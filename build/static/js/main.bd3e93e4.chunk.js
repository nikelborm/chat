(this.webpackJsonpnews=this.webpackJsonpnews||[]).push([[0],{14:function(e,a,t){"use strict";t.r(a);var n=t(0),s=t.n(n),l=t(8),c=t(6),r=t(1),o=t(2),i=t(4),m=t(3),u=t(5);var f=function(e){var a=e.data,t=a.userName,n=a.fullName;return s.a.createElement("li",null,s.a.createElement("a",{href:"#"},s.a.createElement("i",{className:"fa fa-circle-o online",title:t}),s.a.createElement("span",null,n),s.a.createElement("i",{className:"fa fa-times"})))};var d=function(e){var a=e.usersList;return s.a.createElement("ul",null,s.a.createElement("li",{className:"item"},s.a.createElement("a",{href:"#"},s.a.createElement("i",{className:"fa fa-list-alt"}),s.a.createElement("span",null,"\u0423\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0438"))),s.a.createElement("li",{className:"item active"},s.a.createElement("a",{href:"#"},s.a.createElement("i",{className:"fa fa-user"}),s.a.createElement("span",null,"\u041a\u043e\u043c\u0430\u043d\u0434\u0430 \u0447\u0430\u0442\u0430"),s.a.createElement("i",{className:"fa fa-times"}))),s.a.createElement("ul",null,a&&a.map((function(e){return s.a.createElement(f,{key:e.id,data:e})}))),!a.length&&s.a.createElement("strong",null,"\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u0442\u0441\u044f \u0441\u043f\u0438\u0441\u043e\u043a \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432 \u043a\u043e\u043c\u043d\u0430\u0442\u044b..."))};var E=function(e){var a=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return a?decodeURIComponent(a[1]):void 0},p=function(e){function a(){var e,t;Object(r.a)(this,a);for(var n=arguments.length,s=new Array(n),l=0;l<n;l++)s[l]=arguments[l];return(t=Object(i.a)(this,(e=Object(m.a)(a)).call.apply(e,[this].concat(s)))).state={imgIsLoading:!0,imgLink:""},t.componentDidMount=function(){fetch("https://randomuser.me/api/?results=1&inc=picture&noinfo").then((function(e){return e.json()})).then((function(e){t.setState({imgLink:e.results[0].picture.large,imgIsLoading:!1})}))},t}return Object(u.a)(a,e),Object(o.a)(a,[{key:"render",value:function(){var e=E("userName"),a=E("fullName"),t=E("statusText");return s.a.createElement("div",{className:"my-account"},s.a.createElement("div",{className:"image"},s.a.createElement("img",{src:this.state.imgIsLoading?"chat/white.jpg":this.state.imgLink,title:"\u0410\u0432\u0430\u0442\u0430\u0440 \u0432\u044b\u0431\u0438\u0440\u0430\u0435\u0442\u0441\u044f \u0441\u043b\u0443\u0447\u0430\u0439\u043d\u043e",alt:"User"}),s.a.createElement("i",{className:"fa fa-circle online"})),s.a.createElement("div",{className:"name"},s.a.createElement("span",{id:"myName",style:{overflow:"hidden"},title:e},a),s.a.createElement("i",{className:"fa fa-angle-down"}),s.a.createElement("span",{className:"availability"},t)))}}]),a}(n.Component);var h=function(e){var a=e.usersList;return s.a.createElement("div",{className:"conversation-list"},s.a.createElement(d,{usersList:a}),s.a.createElement(p,null))};var g=function(e){var a=e.data,t=a.author,n=a.text,l=a.time,c=E("userName");return s.a.createElement("li",{className:t===c?"me":""},s.a.createElement("div",{className:"name"},s.a.createElement("span",{className:""},t)),s.a.createElement("div",{className:"message"},s.a.createElement("p",null,n.replace(/@(\w{1,50})/g,'<a href="domain.com/$1">$&</a>').replace(/#[\w\u0410-\u042f\u0430-\u044f\u0401\u0451]{1,50}/g,'<a href="#" class="hashtag">$&</a>')),s.a.createElement("span",{className:"msg-time"},l)))},N=function(e){function a(e){var t;return Object(r.a)(this,a),(t=Object(i.a)(this,Object(m.a)(a).call(this,e))).chatList=Object(n.createRef)(),t.down=Object(n.createRef)(),t}return Object(u.a)(a,e),Object(o.a)(a,[{key:"componentDidUpdate",value:function(){this.chatList.current.scrollTo(0,this.down.current.offsetTop)}},{key:"render",value:function(){var e,a=this.props,t=a.msgList;return a.isLoading?e=s.a.createElement("strong",null,"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u044e\u0442\u0441\u044f, \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430 \u043f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435"):t.length||(e=s.a.createElement("strong",null,"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439 \u043f\u043e\u043a\u0430 \u043d\u0435\u0442, \u043d\u043e \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u044d\u0442\u043e \u0438\u0441\u043f\u0440\u0430\u0432\u0438\u0442\u044c!")),s.a.createElement("div",{className:"chat-list",ref:this.chatList,style:{overflowX:"hidden",overflowY:"scroll"}},s.a.createElement("ul",null,t.map((function(e){return s.a.createElement(g,{key:e._id,data:e})}))),e,s.a.createElement("span",{ref:this.down}))}}]),a}(n.Component),v=function(e){function a(e){var t;return Object(r.a)(this,a),(t=Object(i.a)(this,Object(m.a)(a).call(this,e))).sendMsgInChat=function(e){e.preventDefault();var a={room:"global",message:t.inputArea.current.value};fetch(document.location.origin+"/sendMsgInChat",{method:"post",body:JSON.stringify(a),headers:new Headers({"Content-Type":"application/json"})}).then((function(e){return e.json()})).then((function(e){console.log(e)}))},t.inputArea=s.a.createRef(),t}return Object(u.a)(a,e),Object(o.a)(a,[{key:"render",value:function(){var e=this.props,a=e.msgList,t=e.isLoading;return s.a.createElement("div",{className:"chat-area"},s.a.createElement("div",{className:"title"},s.a.createElement("b",null," \u041f\u0435\u0440\u0435\u043f\u0438\u0441\u043a\u0430 "),s.a.createElement("i",{className:"fa fa-search"})),s.a.createElement(N,{msgList:a,isLoading:t}),s.a.createElement("form",{className:"input-area"},s.a.createElement("div",{className:"input-wrapper"},s.a.createElement("input",{type:"text",defaultValue:"",ref:this.inputArea}),s.a.createElement("i",{className:"fa fa-smile-o"}),s.a.createElement("i",{className:"fa fa-paperclip"})),s.a.createElement("button",{onClick:this.sendMsgInChat,className:"send-btn"},">")))}}]),a}(n.Component);var b=function(){return s.a.createElement("ul",{className:"tabs-container"},s.a.createElement("li",{className:"active"},s.a.createElement("ul",{className:"member-list"},s.a.createElement("li",null,s.a.createElement("span",{className:"status online"},s.a.createElement("i",{className:"fa fa-circle-o"})),s.a.createElement("span",null,"Kristi Galeeva")),s.a.createElement("li",null,s.a.createElement("span",{className:"status online"},s.a.createElement("i",{className:"fa fa-circle-o"})),s.a.createElement("span",null,"Segey Bondar")),s.a.createElement("li",null,s.a.createElement("span",{className:"status idle"},s.a.createElement("i",{className:"fa fa-circle-o"})),s.a.createElement("span",null,"Gleb Kavrasky"),s.a.createElement("span",{className:"time"},"10:45 pm")),s.a.createElement("li",null,s.a.createElement("span",{className:"status offline"},s.a.createElement("i",{className:"fa fa-circle-o"})),s.a.createElement("span",null,"David Barto")))),s.a.createElement("li",null),s.a.createElement("li",null))};var L=function(){return s.a.createElement("div",{className:"right-tabs"},s.a.createElement("ul",{className:"tabs"},s.a.createElement("li",{className:"active"},s.a.createElement("a",{href:"#"},s.a.createElement("i",{className:"fa fa-users"}))),s.a.createElement("li",null,s.a.createElement("a",{href:"#"},s.a.createElement("i",{className:"fa fa-paperclip"}))),s.a.createElement("li",null,s.a.createElement("a",{href:"#"},s.a.createElement("i",{className:"fa fa-link"})))),s.a.createElement(b,null),s.a.createElement("i",{className:"fa fa-cog"}))},y=function(e){function a(e){var t;return Object(r.a)(this,a),(t=Object(i.a)(this,Object(m.a)(a).call(this,e))).state={msgList:[],usersList:[],ischatHistoryLoaded:!1,isUsersListInRoomDownloaded:!1},t.componentDidMount=function(){t.loader("/loadChatHistory","msgList","ischatHistoryLoaded"),t.loader("/loadListOfUsersInChat","usersList","isUsersListInRoomDownloaded")},t.loader=function(e,a,n){fetch(document.location.origin+e,{method:"post",body:JSON.stringify({room:"global"}),headers:new Headers({"Content-Type":"application/json"})}).then((function(e){return e.json()})).then((function(e){console.log(e);var s,l=e.reply;e.report.isError||t.setState((s={},Object(c.a)(s,a,l),Object(c.a)(s,n,!0),s))}))},t.componentDidUpdate=function(){if(t.state.ischatHistoryLoaded&&t.state.isUsersListInRoomDownloaded&&!t.cometCreated){var e=new WebSocket("ws://"+document.location.host);e.onopen=function(e){console.info("[open] \u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e")},e.onmessage=function(e){console.info("[message] \u0414\u0430\u043d\u043d\u044b\u0435 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u044b \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u0430:");var a=JSON.parse(e.data);console.log("\u041e\u0442\u0447\u0451\u0442:"),console.log(e),"message"===a.handlerType&&t.setState({msgList:t.state.msgList.concat(a.message)})},e.onclose=function(e){console.info("[close] \u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0437\u0430\u043a\u0440\u044b\u0442\u043e. \u041e\u0442\u0447\u0451\u0442:"),console.log(e)},e.onerror=function(e){console.error("[error] \u041e\u0448\u0438\u0431\u043a\u0430! \u041e\u0442\u0447\u0451\u0442:"),console.log(e)},t.cometCreated=!0}},t.createCometConnection=function(){var e=new WebSocket("wss://"+document.location.host);e.onopen=function(e){console.log("[open] \u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e")},e.onmessage=function(e){console.log("[message] \u0414\u0430\u043d\u043d\u044b\u0435 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u044b \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u0430: ".concat(e.data));var a=JSON.parse(e.data);"message"===a.handlerType&&t.setState({msgList:t.state.msgList.concat(a.message)})},e.onclose=function(e){e.wasClean?console.log("[close] \u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0437\u0430\u043a\u0440\u044b\u0442\u043e \u0447\u0438\u0441\u0442\u043e, \u043a\u043e\u0434=".concat(e.code," \u043f\u0440\u0438\u0447\u0438\u043d\u0430=").concat(e.reason)):console.log("[close] \u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u043f\u0440\u0435\u0440\u0432\u0430\u043d\u043e")},e.onerror=function(e){console.log("[error] ".concat(e.message))}},t.cometCreated=!1,t}return Object(u.a)(a,e),Object(o.a)(a,[{key:"render",value:function(){var e=this.state,a=e.msgList,t=e.ischatHistoryLoaded,n=e.usersList;return s.a.createElement("div",{className:"window-area"},s.a.createElement(h,{usersList:n}),s.a.createElement(v,{msgList:a,isLoading:!t}),s.a.createElement(L,null))}}]),a}(n.Component);var j=function(){return s.a.createElement("div",{className:"window-title"},s.a.createElement("div",{className:"dots"},s.a.createElement("i",{className:"fa fa-circle"}),s.a.createElement("i",{className:"fa fa-circle"}),s.a.createElement("i",{className:"fa fa-circle"})),s.a.createElement("div",{className:"title"},s.a.createElement("span",null,"\u0427\u0430\u0442")),s.a.createElement("div",{className:"expand"},s.a.createElement("i",{className:"fa fa-expand"})))};var w=function(){return s.a.createElement(n.Fragment,null,s.a.createElement(j,null),s.a.createElement(y,null))};Object(l.render)(s.a.createElement(w,null),document.getElementById("root"))},9:function(e,a,t){e.exports=t(14)}},[[9,1,2]]]);
//# sourceMappingURL=main.bd3e93e4.chunk.js.map