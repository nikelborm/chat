(this.webpackJsonpnews=this.webpackJsonpnews||[]).push([[0],{14:function(e,a,t){"use strict";t.r(a);var n=t(0),l=t.n(n),s=t(8),r=t(6),c=t(1),i=t(2),o=t(4),m=t(3),u=t(5);var f=function(e){var a=e.data,t=a.userName,n=a.fullName,s=a.onlineStatus;return l.a.createElement("li",null,l.a.createElement("a",{href:"#"},l.a.createElement("i",{className:"fa fa-circle-o "+s,title:t}),l.a.createElement("span",null,n),l.a.createElement("i",{className:"fa fa-times"})))};var d=function(e){var a=e.usersList,t=[];for(var n in a)a.hasOwnProperty(n)&&t.push(l.a.createElement(f,{key:n,data:a[n]}));return l.a.createElement("ul",null,l.a.createElement("li",{className:"item"},l.a.createElement("a",{href:"#"},l.a.createElement("i",{className:"fa fa-list-alt"}),l.a.createElement("span",null,"\u0423\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0438"))),l.a.createElement("ul",null,t),!t.length&&l.a.createElement("strong",null,"\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u0442\u0441\u044f \u0441\u043f\u0438\u0441\u043e\u043a \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432 \u043a\u043e\u043c\u043d\u0430\u0442\u044b..."))};var E=function(e){var a=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return a?decodeURIComponent(a[1]):void 0},p=function(e){function a(){var e,t;Object(c.a)(this,a);for(var n=arguments.length,l=new Array(n),s=0;s<n;s++)l[s]=arguments[s];return(t=Object(o.a)(this,(e=Object(m.a)(a)).call.apply(e,[this].concat(l)))).state={imgIsLoading:!0,imgLink:""},t.componentDidMount=function(){fetch("https://randomuser.me/api/?results=1&inc=picture&noinfo").then((function(e){return e.json()})).then((function(e){t.setState({imgLink:e.results[0].picture.large,imgIsLoading:!1})}))},t}return Object(u.a)(a,e),Object(i.a)(a,[{key:"render",value:function(){var e=E("userName"),a=E("fullName"),t=E("statusText");return l.a.createElement("div",{className:"my-account"},l.a.createElement("div",{className:"image"},l.a.createElement("img",{src:this.state.imgIsLoading?"chat/white.jpg":this.state.imgLink,title:"\u0410\u0432\u0430\u0442\u0430\u0440 \u0432\u044b\u0431\u0438\u0440\u0430\u0435\u0442\u0441\u044f \u0441\u043b\u0443\u0447\u0430\u0439\u043d\u043e",alt:"User"}),l.a.createElement("i",{className:"fa fa-circle online"})),l.a.createElement("div",{className:"name"},l.a.createElement("span",{id:"myName",style:{overflow:"hidden"},title:e},a),l.a.createElement("i",{className:"fa fa-angle-down"}),l.a.createElement("span",{className:"availability"},t)))}}]),a}(n.Component);var h=function(e){var a=e.usersList;return l.a.createElement("div",{className:"conversation-list"},l.a.createElement(d,{usersList:a}),l.a.createElement(p,null))};var g=function(e){var a=e.data,t=a.author,n=a.text,s=a.time,r=E("userName");return l.a.createElement("li",{className:t===r?"me":""},l.a.createElement("div",{className:"name"},l.a.createElement("span",{className:""},t)),l.a.createElement("div",{className:"message"},l.a.createElement("p",null,n.replace(/@(\w{1,50})/g,'<a href="domain.com/$1">$&</a>').replace(/#[\w\u0410-\u042f\u0430-\u044f\u0401\u0451]{1,50}/g,'<a href="#" class="hashtag">$&</a>')),l.a.createElement("span",{className:"msg-time"},s)))},v=function(e){function a(e){var t;return Object(c.a)(this,a),(t=Object(o.a)(this,Object(m.a)(a).call(this,e))).chatList=Object(n.createRef)(),t.down=Object(n.createRef)(),t}return Object(u.a)(a,e),Object(i.a)(a,[{key:"componentDidUpdate",value:function(){this.chatList.current.scrollTo(0,this.down.current.offsetTop)}},{key:"render",value:function(){var e,a=this.props,t=a.msgList;return a.isLoading?e=l.a.createElement("strong",null,"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u044e\u0442\u0441\u044f, \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430 \u043f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435"):t.length||(e=l.a.createElement("strong",null,"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439 \u043f\u043e\u043a\u0430 \u043d\u0435\u0442, \u043d\u043e \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u044d\u0442\u043e \u0438\u0441\u043f\u0440\u0430\u0432\u0438\u0442\u044c!")),l.a.createElement("div",{className:"chat-list",ref:this.chatList,style:{overflowX:"hidden",overflowY:"scroll"}},l.a.createElement("ul",null,t.map((function(e){return l.a.createElement(g,{key:e._id,data:e})}))),e,l.a.createElement("span",{ref:this.down}))}}]),a}(n.Component),N=function(e){function a(e){var t;return Object(c.a)(this,a),(t=Object(o.a)(this,Object(m.a)(a).call(this,e))).sendMsgInChat=function(e){e.preventDefault();var a={room:"global",message:t.inputArea.current.value};fetch(document.location.origin+"/sendMsgInChat",{method:"post",body:JSON.stringify(a),headers:new Headers({"Content-Type":"application/json"})}).then((function(e){return e.json()})).then((function(e){console.log(e)}))},t.inputArea=l.a.createRef(),t}return Object(u.a)(a,e),Object(i.a)(a,[{key:"render",value:function(){var e=this.props,a=e.msgList,t=e.isLoading;return l.a.createElement("div",{className:"chat-area"},l.a.createElement("div",{className:"title"},l.a.createElement("b",null," \u041f\u0435\u0440\u0435\u043f\u0438\u0441\u043a\u0430 "),l.a.createElement("i",{className:"fa fa-search"})),l.a.createElement(v,{msgList:a,isLoading:t}),l.a.createElement("form",{className:"input-area"},l.a.createElement("div",{className:"input-wrapper"},l.a.createElement("input",{type:"text",defaultValue:"",ref:this.inputArea}),l.a.createElement("i",{className:"fa fa-smile-o"}),l.a.createElement("i",{className:"fa fa-paperclip"})),l.a.createElement("button",{onClick:this.sendMsgInChat,className:"send-btn"},">")))}}]),a}(n.Component);var b=function(){return l.a.createElement("ul",{className:"tabs-container"},l.a.createElement("li",{className:"active"},l.a.createElement("ul",{className:"member-list"},l.a.createElement("li",null,l.a.createElement("span",{className:"status online"},l.a.createElement("i",{className:"fa fa-circle-o"})),l.a.createElement("span",null,"Kristi Galeeva")),l.a.createElement("li",null,l.a.createElement("span",{className:"status online"},l.a.createElement("i",{className:"fa fa-circle-o"})),l.a.createElement("span",null,"Segey Bondar")),l.a.createElement("li",null,l.a.createElement("span",{className:"status idle"},l.a.createElement("i",{className:"fa fa-circle-o"})),l.a.createElement("span",null,"Gleb Kavrasky"),l.a.createElement("span",{className:"time"},"10:45 pm")),l.a.createElement("li",null,l.a.createElement("span",{className:"status offline"},l.a.createElement("i",{className:"fa fa-circle-o"})),l.a.createElement("span",null,"David Barto")))),l.a.createElement("li",null),l.a.createElement("li",null))};var y=function(){return l.a.createElement("div",{className:"right-tabs"},l.a.createElement("ul",{className:"tabs"},l.a.createElement("li",{className:"active"},l.a.createElement("a",{href:"#"},l.a.createElement("i",{className:"fa fa-users"}))),l.a.createElement("li",null,l.a.createElement("a",{href:"#"},l.a.createElement("i",{className:"fa fa-paperclip"}))),l.a.createElement("li",null,l.a.createElement("a",{href:"#"},l.a.createElement("i",{className:"fa fa-link"})))),l.a.createElement(b,null),l.a.createElement("i",{className:"fa fa-cog"}))},L=function(e){function a(e){var t;return Object(c.a)(this,a),(t=Object(o.a)(this,Object(m.a)(a).call(this,e))).state={msgList:[],usersInGlobalRoom:{},ischatHistoryLoaded:!1,isUsersListInRoomDownloaded:!1},t.componentDidMount=function(){t.loader("/loadChatHistory","msgList","ischatHistoryLoaded"),t.loader("/loadListOfUsersInChat","usersInGlobalRoom","isUsersListInRoomDownloaded")},t.loader=function(e,a,n){fetch(document.location.origin+e,{method:"post",body:JSON.stringify({room:"global"}),headers:new Headers({"Content-Type":"application/json"})}).then((function(e){return e.json()})).then((function(e){console.log(e);var l,s=e.reply;e.report.isError||t.setState((l={},Object(r.a)(l,a,s),Object(r.a)(l,n,!0),l))}))},t.componentDidUpdate=function(){if(t.state.ischatHistoryLoaded&&t.state.isUsersListInRoomDownloaded&&!t.cometCreated){var e=new WebSocket("ws://"+document.location.host);e.onopen=function(e){console.log("[open] \u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e")},e.onmessage=function(e){console.log("[message] \u0414\u0430\u043d\u043d\u044b\u0435 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u044b \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u0430:");var a=JSON.parse(e.data);console.log("\u041e\u0442\u0447\u0451\u0442:"),console.log(e),console.log(a),"message"===a.handlerType?t.setState({msgList:t.state.msgList.concat(a.message)}):"isOnline"===a.handlerType?t.setState((function(e){return e.usersInGlobalRoom[a._id].onlineStatus="online",e})):"isOffline"===a.handlerType&&t.setState((function(e){return e.usersInGlobalRoom[a._id].onlineStatus="offline",e}))},e.onclose=function(e){console.log("[close] \u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0437\u0430\u043a\u0440\u044b\u0442\u043e. \u041e\u0442\u0447\u0451\u0442:"),console.log(e)},e.onerror=function(e){console.error("[error] \u041e\u0448\u0438\u0431\u043a\u0430! \u041e\u0442\u0447\u0451\u0442:"),console.log(e)},t.cometCreated=!0}},t.cometCreated=!1,t}return Object(u.a)(a,e),Object(i.a)(a,[{key:"render",value:function(){var e=this.state,a=e.msgList,t=e.ischatHistoryLoaded,n=e.usersInGlobalRoom;return l.a.createElement("div",{className:"window-area"},l.a.createElement(h,{usersList:n}),l.a.createElement(N,{msgList:a,isLoading:!t}),l.a.createElement(y,null))}}]),a}(n.Component);var O=function(){return l.a.createElement("div",{className:"window-title"},l.a.createElement("div",{className:"dots"},l.a.createElement("i",{className:"fa fa-circle"}),l.a.createElement("i",{className:"fa fa-circle"}),l.a.createElement("i",{className:"fa fa-circle"})),l.a.createElement("div",{className:"title"},l.a.createElement("span",null,"\u0427\u0430\u0442")),l.a.createElement("div",{className:"expand"},l.a.createElement("i",{className:"fa fa-expand"})))};var j=function(){return l.a.createElement(n.Fragment,null,l.a.createElement(O,null),l.a.createElement(L,null))};Object(s.render)(l.a.createElement(j,null),document.getElementById("root"))},9:function(e,a,t){e.exports=t(14)}},[[9,1,2]]]);
//# sourceMappingURL=main.0f709e23.chunk.js.map